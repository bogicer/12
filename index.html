<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Газета Вісточка</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#2b4c7e; color:#000; }
header { background:#48e0b4; padding:10px 20px; display:flex; justify-content:space-between; align-items:center; }
header h1 { margin:0; font-size:28px; }
table button { margin-left:10px; padding:5px 15px; background:#90ee90; border:none; border-radius:5px; cursor:pointer; }
table button:hover { background:#7dd77d; }
h2 { color:#57ff57; margin-left:20px; }
.news-container { display:flex; flex-direction:column; align-items:center; gap:20px; padding:20px; }
.news-card { width:80%; background:#7ea7d9; border-radius:10px; padding:10px; box-sizing:border-box; }
.news-card img { max-width:100%; border-radius:8px; margin-top:10px; }
.actions { margin-top:10px; }
.actions button { margin-right:10px; padding:5px 10px; background:#ffd966; border:none; border-radius:5px; cursor:pointer; }
.actions button.delete { background:#ff7f7f; }
.page { display:none; }
.active { display:block; }
.login-box { display:flex; flex-direction:column; width:250px; margin:30px auto; padding:20px; background:#7ea7d9; border-radius:10px; }
.login-box input, textarea { margin-bottom:10px; padding:8px; border-radius:5px; border:none; }
.toggle-link { color:blue; text-decoration:underline; cursor:pointer; margin-top:10px; text-align:center; }
</style>
</head>
<body>
<header>
  <h1>Газета Вісточка</h1>
  <table>
    <tr>
      <td><button onclick="showPage('home')">Головна сторінка</button></td>
      <td><button onclick="showPage('cabinet')">Кабінет</button></td>
    </tr>
  </table>
</header>

<div id="home" class="page active">
  <h2>НОВИНИ</h2>
  <div class="news-container" id="news-list"></div>
</div>

<div id="cabinet" class="page">
  <h2>Кабінет</h2>

  <div id="loginBox" class="login-box">
    <h3>Вхід</h3>
    <input type="text" id="loginUsername" placeholder="Логін">
    <input type="password" id="loginPassword" placeholder="Пароль">
    <button onclick="login()">Увійти</button>
    <div class="toggle-link" onclick="toggleAuth('registerBox','loginBox')">Ще не маєш акаунту? Зареєструйся</div>
  </div>

  <div id="registerBox" class="login-box" style="display:none;">
    <h3>Реєстрація</h3>
    <input type="text" id="regUsername" placeholder="Логін">
    <input type="password" id="regPassword" placeholder="Пароль">
    <button onclick="register()">Зареєструватися</button>
    <div class="toggle-link" onclick="toggleAuth('loginBox','registerBox')">Вже є акаунт? Увійди</div>
  </div>

  <div id="editor" style="display:none; text-align:center;">
    <p>Напишіть статтю:</p>
    <textarea id="articleText" style="width:80%;height:100px;"></textarea><br>
    <input type="file" id="articleImage" accept="image/*"><br><br>
    <button onclick="addArticle()">Додати статтю</button>
  </div>
</div>

<script>
let currentUser = null;

function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(pageId).classList.add('active');
}

function toggleAuth(showId, hideId) {
  document.getElementById(showId).style.display="block";
  document.getElementById(hideId).style.display="none";
}

function register() {
  const user=document.getElementById("regUsername").value.trim();
  const pass=document.getElementById("regPassword").value.trim();
  if(!user||!pass){alert("Заповніть усі поля!"); return;}
  let users=JSON.parse(localStorage.getItem("users")||"{}");
  if(users[user]){alert("Такий логін вже існує!"); return;}
  users[user]=pass;
  localStorage.setItem("users",JSON.stringify(users));
  alert("Акаунт створено! Тепер увійдіть.");
  toggleAuth("loginBox","registerBox");
}

function login() {
  const user=document.getElementById("loginUsername").value.trim();
  const pass=document.getElementById("loginPassword").value.trim();
  let users=JSON.parse(localStorage.getItem("users")||"{}");
  if(users[user] && users[user]===pass){
    currentUser=user;
    document.getElementById("loginBox").style.display="none";
    document.getElementById("editor").style.display="block";
  } else alert("Невірний логін або пароль!");
}

function loadArticles() {
  const newsList=document.getElementById("news-list");
  const articles=JSON.parse(localStorage.getItem("articles")||"[]");
  articles.forEach(a=>createArticleCard(a.text,a.image,newsList));
}

function addArticle() {
  const text=document.getElementById("articleText").value.trim();
  const file=document.getElementById("articleImage").files[0];
  if(!text&&!file){alert("Напишіть текст або додайте фото!"); return;}
  if(file){
    const reader=new FileReader();
    reader.onload=function(e){saveAndCreateArticle(text,e.target.result);}
    reader.readAsDataURL(file);
  } else saveAndCreateArticle(text,null);
  document.getElementById("articleText").value="";
  document.getElementById("articleImage").value="";
  showPage('home');
}

function saveAndCreateArticle(text,image){
  let articles=JSON.parse(localStorage.getItem("articles")||"[]");
  articles.unshift({text,image});
  localStorage.setItem("articles",JSON.stringify(articles));
  const newsList=document.getElementById("news-list");
  createArticleCard(text,image,newsList);
}

function createArticleCard(text,image,container){
  const card=document.createElement("div");
  card.className="news-card";
  if(text){const p=document.createElement("p"); p.textContent=text; card.appendChild(p);}
  if(image){const img=document.createElement("img"); img.src=image; card.appendChild(img);}
  const actions=document.createElement("div"); actions.className="actions";

  const editBtn=document.createElement("button");
  editBtn.textContent="Редагувати";
  editBtn.onclick=function(){
    const p=card.querySelector("p");
    const newText=prompt("Введіть новий текст:",p?p.textContent:"");
    if(newText!==null){ 
      if(p){p.textContent=newText;} else {const newP=document.createElement("p"); newP.textContent=newText; card.insertBefore(newP,actions);}
      updateLocalStorage();
    }
  };
  actions.appendChild(editBtn);

  const delBtn=document.createElement("button");
  delBtn.textContent="Видалити"; delBtn.className="delete";
  delBtn.onclick=function(){ card.remove(); updateLocalStorage(); };
  actions.appendChild(delBtn);

  card.appendChild(actions);
  container.prepend(card);
}

function updateLocalStorage(){
  const newsList=document.getElementById("news-list");
  const articles=[];
  newsList.querySelectorAll(".news-card").forEach(card=>{
    const text=card.querySelector("p")?card.querySelector("p").textContent:"";
    const img=card.querySelector("img")?card.querySelector("img").src:null;
    articles.push({text,image:img});
  });
  localStorage.setItem("articles",JSON.stringify(articles));
}

window.onload=loadArticles;
</script>
</body>
</html>
